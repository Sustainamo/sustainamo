
<div id="toc" class="toc-outline"></div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toc = document.getElementById("toc");
    const maxDepth = {{ include.max_depth | default: 3 }};
    const container = document.querySelector(".page-content");
    const headers = [...container.querySelectorAll("h2, h3, h4, h5, h6")];

    if (headers.length === 0) return;

    const ul = document.createElement("ul");
    headers.forEach(h => {
      const level = parseInt(h.tagName[1]);
      if (level > maxDepth) return;

      h.id = h.id || h.textContent.trim().toLowerCase().replace(/\s+/g, '-').replace(/[^\w\-]/g, '');
      const li = document.createElement("li");
      const link = document.createElement("a");

      link.href = `#${h.id}`;
      link.textContent = h.textContent;
      li.style.marginLeft = `${(level - 2) * 1.5}rem`;
      li.appendChild(link);
      ul.appendChild(li);
    });

    toc.appendChild(ul);
  });
</script>